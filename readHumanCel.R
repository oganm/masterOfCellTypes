require(RCurl)
eval( expr = parse( text = getURL(
    "https://raw.githubusercontent.com/oganm/toSource/master/ogbox.R",
    ssl.verifypeer=FALSE) ))
library(oligo)
library(pd.huex.1.0.st.v2)
sourceGithub(OganM,toSource,gemmaAnnotate)
readHumanCel = function(GSMs, fileOut=NULL, humanDir){
    cels = oligoClasses::list.celfiles(humanDir,listGzipped=T)
    whichCels = sapply(GSMs, function(x){which(grepl(x,cels))})
    sampleCels = cels[whichCels]
    affyRaw = oligo::read.celfiles(paste0(humanDir,'/',sampleCels))
    exonTS <- oligo::rma(affyRaw, target = "core")
    rm(affyRaw)
    featureData(exonTS) <- getNetAffx(exonTS, "transcript")
    #View the features of the obtained data
    # exonTS
    #Extract the expression data
    
    aned = gemmaAnnotOligo(normalized=exonTS,chipFile='Data/GemmaAnnots/GPL5175')
    
    #Create the expression file
    if (!is.null(fileOut)){
        write.csv(aned, fileOut, row.names=FALSE)
    }
    invisible(aned)
}